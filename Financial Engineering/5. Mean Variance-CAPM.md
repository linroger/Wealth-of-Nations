---
linter-yaml-title-alias: 5. Mean Variance-CAPM
title: 5. Mean Variance-CAPM
tags:
  - binomial_model
  - capm
  - forward_contracts
  - mean_variance
  - stochastic_cashflows
aliases:
  - Forwards, Swaps, Futures, Options
  - Mean-Variance-CAPM
key_concepts:
  - binomial model framework
  - deterministic cash flow value
  - forward contract definition
  - forward contract examples
  - stochastic cash-flows pricing
---

# 5. Mean Variance-CAPM

These notes introduce forwards,  swaps,  futures and options as well as the basic mechanics of their associated markets. We will also see how to price forwards and swaps,  but we will defer the pricing of futures contracts until after we have studied martingale pricing. We will see how to price options within the binomial model framework.

With the exception of the binomial model in Section 4,  the underlying probability structure of the financial market plays only a small role in these notes. Nonetheless,  you should not be under the impression that the results we derive only hold for deterministic models and are therefore limited in scope. On the contrary,  many of the results we derive are very general and hold irrespective of the underlying probability structure that we might find ourselves working with.

Finally,  we mention that it is easy to compute the value of a deterministic cash flow given the current term-structure of interest rates and we will often make use of this observation when pricing forwards and swaps.

Pricing securities with *stochastic* cash-flows is more complicated and requires more sophisticated no-arbitrage or equilibrium methods. The binomial model of Section 4,  however,  provides a simple yet important model for introducing some of these methods. We will study them in more generality and much greater detail when we study martingale pricing later in the course.

## 1 Forwards

Definition 1 *A forward contract on a security (or commodity) is a contract agreed upon at date* t = 0 to purchase or sell the security at date T for a price,  F*,  that is specified at* t = 0. When the forward contract is established at date t = 0,  the forward price,  F,  is set in such a way that the initial value of the forward contract,  f0,  satisfies f0 = 0. At the maturity date,  T,  the value of the contract is given2 by fT = ±(ST − F) where ST is the time T value of the underlying security (or commodity). It is very important to realize that there are two "prices" or "values" associated with a forward contract at time t: ft and F. When we use the term "contract value" or "forward value" we will always be referring to ft,  whereas when we use the term "contract price" or "forward price" we will always be referring to F. That said,  there should never be any ambiguity since ft is fixed (equal to zero) at t = 0,  and F is fixed for all t > 0 so the particular quantity in question should be clear from the context. Note that ft need not be (and generally is not)
equal to zero for t > 0.

Examples of forward contracts include:

- A forward contract for delivery (i.e. purchase) of a non-dividend paying stock with maturity 6 months. - A forward contract for delivery of a 9-month T-Bill with maturity 3 months. (This means that upon delivery,  the T-Bill has 9 months to maturity.)
- A forward contract for the sale of gold with maturity 1 year. - A forward contract for delivery of 10m Euro (in exchange for dollars) with maturity 6 months.

1The notes draw heavily from David Luenberger's *Investment Science* (Oxford University Press,  1997).

2If the contact specifies a purchase of the security then the date T payoff is ST − F whereas if the contact specifies a sale of the security then the payoff is F − ST.

## 1.1 Computing Forward Prices

We first consider forward contracts on securities that can be *stored* at zero cost. The origin of the term "stored" is that of forward contracts on commodities such as gold or oil which typically are costly to store. However,  we will also use the term when referring to financial securities. For example,  while non-dividend paying stocks and zero-coupon bonds may be stored at zero cost,  it is also the case that dividend paying stocks and coupon paying bonds can be stored at a *negative* cost.

## Forward Contracts On Securities With Zero Storage Costs

Suppose a security can be stored at zero cost and that short3selling is allowed. Then the forward price,  F,  at t = 0 for delivery of that security at date T is given by

$$F\ =\ S/d(0,       T)$$
$$(1)$$

where S is the current spot price of the security and d(0,  T) is the discount factor applying to the interval \[0,  T].

Proof: The proof works by constructing an arbitrage portfolio if F 6= S/d(0,  T).

Case (i): *F < S/d*(0,  T): Consider the portfolio that at date t = 0 is short one unit of the security,  lends S
until date T,  and is long one forward contract. The initial cost of this portfolio is 0 and it has a positive payoff,  S/d(0,  T) − F,  at date T. Hence it is an arbitrage.

Case (ii): F > S/d(0,  T): In this case,  construct the reverse portfolio and again obtain an arbitrage opportunity.

Example 1 (A Forward on a Non-Dividend Paying Stock)
Consider a forward contract on a non-dividend paying stock that matures in 6 months. The current stock price is $50 and the 6-month interest rate is 4% per annum. Compute the forward price,  F.

Solution: Assuming semi-annual compounding,  the discount factor is given by d(0,  0.\1) = 1/1.02 = 0.9804.

Equation (1) then implies that F = 50/0.9804 = 51.0.

Forward Contracts on Securities with Non-Zero Storage Costs Suppose now that we wish to compute the forward price of a security that has non-zero storage costs. We will assume that we are working in a multi-period setting and that the security has a deterministic holding cost of c(j) in period j,  payable at the beginning of the period. Note that for a commodity,  c(j) will generally represent a true holding cost,  whereas for a stock or bond,  c(j) will be a negative cost and represent a dividend or coupon payment. Forward Price for a Security with Non-Zero Storage Costs: Suppose a security can be stored for period j at a cost of c(j),  payable at the beginning of the period. Assuming that the security may also be sold short,  then the forward price,  F,  for delivery of that security at date T (assumed to be M periods away) is given by

F =S d(0,  M)+ M X−1 j=0 c(j) d(j,  M)(2)
$$\left(2\right)$$
where S is the current spot price of the security and d(*j,  M*) is the discount factor between dates j and M.

Proof: As before,  we could prove (2) using an arbitrage argument. An alternative proof is to consider the strategy of buying one unit of the security on the spot market at t = 0,  and simultaneously entering a forward contract to deliver it at time T. The cash-flow associated with this strategy is

$$(-S-c(0),       -c(1),       $$
$,       -c(j),       \;\hdots$.
(−S − c(0),  −c(1),  …,  −c(j)*,  …,  * −c(M − 1),  F)

3The act of short-selling a security is achieved by first borrowing the security from somebody and then selling it in the market. Eventually the security is repurchased and returned to the original lender. Note that a profit (loss) is made if the security price fell (rose) in value between the times it was sold and purchased in the market.
and its present value must (why?) be equal to zero. Since the cash-flow is deterministic we know how to compute its present value and we easily obtain (2). Example 2 (A Bond Forward) Consider a forward contract on a 4-year bond with maturity 1 year. The current value of the bond is $1018.86,        it has a face value of $1000 and a coupon rate of 10% per annum. A coupon has just been paid on the bond and further coupons will be paid after 6 months and after 1 year,  just prior to delivery. Interest rates for 1 year out are flat at 8%. Compute the forward price of the bond.

Solution: Note that in this problem,  the 'storage costs' (i.e. the coupon payments) are paid at the end of the period,  which in this example is of length 6 months. As a result,  we need to adjust (2) slightly to obtain

$$F\ =\ \frac{S}{d(0,       M)}\ +\ \sum_{j=0}^{M-1}\frac{c(j)}{d(j+1,       M)}.$$
$$\left({\mathfrak{3}}\right)$$
In particular,  we now obtain
$$F~=~{\frac{1018.86}{d(0,       2)}}~-~{\frac{50}{d(1,       2)}}~-~50$$
$$=d(0,       2)/d(0,       1)=1.04^{-1}$$
$$\;=\;(F_{t}-F_{0})\;d(t,       T).$$
$$f_{t}$$
$\mathbf{a}\cdot\mathbf{a}=\mathbf{a}\cdot\mathbf{a}$.

where d(0,  2) = 1.04−2and d(1,  2) = d(0,  2)/d(0,  1) = 1.04−1.

## 1.2 Computing The Value Of A Forward Contract When T > 0

So far we have discussed how to compute F = F0,  the forward price at date 0 for delivery of a security at date T. We now concentrate on computing the forward value,  ft,  for t > 0. (Recall that by construction,  f0 = 0.) Let Ft be the current forward price at date t for delivery of the same security at the same maturity date,  T.

Then we have ft = (Ft − F0) d(*t,  T*). (3)
Proof: Consider a portfolio that at date t goes long one unit of a forward contract with price Ft and maturity T,  and short one unit of a forward contract with price F0 and maturity T. This portfolio has a deterministic cash-flow of F0 − Ft at date T and a deterministic cash-flow of ft at date t. The present value at date t of this cash-flow stream,  (ft,  F0 − Ft) must be zero (why?) and hence we obtain (3).

## 1.3 Tight Markets

Examination of equation (2) implies that the forward price for a commodity with positive storage costs should be increasing in M. Frequently,  however,  this is not the case and yet it turns out that arbitrage opportunities do not exist. This apparent contradiction can be explained by the fact that it is not always possible to short commodities,  either because they are in scarce supply,  or because holders of the commodity are not willing to lend them to would-be short sellers. The latter situation might occur,  for example,  if the commodity has a utility value over and beyond its spot market value.

If short selling is not allowed,  then the arbitrage argument used to derive (2) is no longer valid. In particular,  we can only conclude that

$$F\ \leq\ \frac{S}{d(0,       M)}\ +\ \sum_{j=0}^{M-1}\frac{c(j)}{d(j,       M)}.$$
$$\left(4\right)$$
. (4)
Exercise 1 Convince4yourself that we can indeed only conclude that (4) is true if short-selling is not permitted.

4See Luenberger,  Chapter 10,  for a discussion of tight markets.

In such circumstances,  we say that the market is *tight*. An artifice that is often used to restore equality in (4) is that of the *convenience yield*. The convenience yield,  y,  is defined in such a way that the following equation is satisfied.

$$F\ =\ \frac{S}{d(0,       M)}\ +\ \sum_{j=0}^{M-1}\frac{c(j)-y}{d(j,       M)}.$$

$\left(5\right)^3$
. (5)
The convenience yield may be thought of as a negative holding cost that measures the convenience per period of having the commodity on hand.

## 2 Swaps

Another important class of derivative security are *swaps*,  perhaps the most common of which are interest rate swaps and currency swaps. Other types of swaps include equity and commodity swaps. A *plain vanilla swap* usually involves one party swapping a series of fixed level payments for a series of variable payments.

Swaps were introduced primarily for their use in risk-management. For example,  it is often the case that a party faces a stream of obligations that are *floating* or stochastic,  but that it will have to meet these obligations with a stream of fixed payments. Because of this mismatch between floating and fixed,  there is no guarantee that the party will be able to meet its obligations. However,  if the present value of the fixed stream is greater than or equal to the present value of the floating stream,  then it could purchase an appropriate swap and thereby ensure than it can meet its obligations.

## 2.1 Plain Vanilla Interest Rate Swaps

In a plain vanilla interest rate swap,  there is a maturity date,  T,  a *notional principal*,  P,  and a fixed5 number of periods,  M. There are two parties,  A and B say,  to the swap. Every period party A makes a payment to party B corresponding to a fixed rate of interest on P. Similarly,  in every period party B makes a payment to party A
that corresponds to a floating rate of interest on the same notional principal,  P.

It is important to note that the principal itself,  P,  is never exchanged. Moreover,  it is also important to specify whether the payments occur at the end or the beginning of each period.

For example,  assuming cash payments are made at the end of periods,  i.e. in *arrears*,  the total aggregate cash cash flow from party A's perspective is given by

$C=P\times(0,       $$\underbrace{r_{0}-r_{f}}_{\text{At end of}1^{st}\text{period}}$,  $\underbrace{r_{M-1}-r_{f}}_{\text{At end of}M^{th}\text{period}}$
where rf is the constant fixed rate and riis the floating rate that prevailed at the beginning of period i. In general,  ri will be stochastic and so the swap's cash-flow,  C,  will also be stochastic. As is the case with forward contracts,  the value X (equivalently rf) is usually chosen in such a way that the initial value of the swap is zero.

Even though the initial value of the swap is zero,  we say that party A is "long" the swap and party B is "short" the swap.

Exercise 2 *Make sure you understand how to use the terms "long" and "short" when referring to a swap.*

## 2.2 Currency Swaps

A simple type of currency swap would be an agreement between two parties to exchange fixed rate interest payments and the principal on a loan in one currency for fixed rate interest payments and the principal on a loan in another currency. Note that for such a swap,  the uncertainty in the cash flow is due to uncertainty in the currency exchange rate. In a Dollar/Euro swap,  for example,  a US company may receive the Euro payments of 5It is assumed that the date of the terminal payment coincides with the maturity date,  T.

the swap while a German company might receive the dollar payments. Note that the value of the swap to each party will vary as the USD/Euro exchange rate varies. As a result,  the companies are exposed to foreign exchange risk but if necessary this risk can be hedged by trading in the forward foreign exchange market. Why might the US and German companies enter such a transaction? A possible explanation might be that the US company wishes to invest in the Eurozone while the German country wishes to invest in the U.S. Each company therefore needs foreign currency. However,  they may have a comparative advantage borrowing in their domestic currency at home as opposed to borrowing in a foreign currency abroad. If this is the case,  it makes sense to borrow domestic currency at home and use a swap to convert it into the foreign currency.

## 2.3 Pricing Swaps

Pricing swaps is quite straightforward. For example,  in the currency swap described above,  it is easily seen that the swap cash-flow is equivalent to being long a bond in one currency and short the bond in another currency.

Therefore,  all that is needed to price6the swap is the term structure of interest rates in each currency (to price the bonds) and the spot currency exchange rate.

More generally,  we will see that the cash-flow stream of a swap can often be considered as a stream of forward contracts. Since we can price forward contracts,  we will be able to price7swaps. We will see how to do this by way of the first example below where we price a commodity swap.

## Example 3 (Pricing A Commodity Swap)

Let Si be the spot price of a commodity at the beginning of period i. Party A receives the spot price for N
units of the commodity and pays a fixed amount,  X,  per period. We will assume that payments take place at the beginning of the period and there will be a total of M payments,  beginning one period from now. The cash-flow as seen by the party that is long the swap is

$C\;=\;N\times(0)$.
$C=N\times(0,       \ S_{1}-X,       \ S_{2}-X,       \ \ldots\,       \ S_{M}-X)\,      .$
Note that this cash-flow is stochastic and so we cannot compute its present value directly by discounting.

However,  we can decompose C into a stream of fixed payments (of −NX) that we can easily price,  and a stochastic stream,  N(0,  S1,  S2*,  …,  S*M). The stochastic stream is easily seen to be equivalent to a stream of forward contacts on N units of the commodity. We then see that receiving NSi at period i has the same value of receiving NFi at period i where Fiis the date 0 forward price for delivery of one unit of the commodity at date i. As the forward prices,  Fi,  are deterministic and known at date 0,  we can see that the value of the commodity swap is given by

$$V\ =\ N\sum_{i=1}^{M}d(0,       i)(F_{i}-X).$$

X is usually chosen so that the initial value of V is zero.

Example 4 (Pricing an Interest Rate Swap)
Party A agrees to make payments of a fixed rate of interest,  rf,  on a notional principal,  P,  while receiving floating rate payments on P for M periods. We assume that the payments are made at the end of each period and that the floating rate payment will be based on the short rate that prevailed at the beginning of the period.

The cash-flow corresponding to the long side of the swap is then given by

$C=P\left(0,       \ r_{0}-r_{f},       \ r_{1}-r_{f},       \ \ldots\,       \ r_{M-1}-r_{f}\right)$.
where riis the short rate for the period beginning at date i. Again this cash flow can be decomposed into a series of fixed payments that can be easily priced,  and a stochastic stream,  P(0,  r0,  r1*,  …,  r*M−1). We can 6As mentioned above,  the fixed payment stream of a swap is usually chosen so that the initial swap value is zero. However,  once the swap is established its value will then vary stochastically and will not in general be zero.

7Later in the course we will develop the theory of martingale pricing. Then we will be able to price swaps directly,  without needing to decompose it into a series of of forward contracts.
value the stochastic stream either using an arbitrage argument or by recalling that the price of a floating rate bond is always par at any reset point. Note that the stochastic stream is exactly the stream of coupon payments corresponding to a floating rate bond with face value P. Hence the value of the stochastic stream must be
(why?) P(1 − d(0,  M)) and so the value of the swap is given by

$$V~=~P\left[1-d(0,       M)-r_{f}\sum_{i=1}^{M}d(0,       i)\right].$$
$$(6)$$
. (6)
As before,  rf is usually chosen so that the initial value of the swap is zero.

## 3 Futures

While forwards markets have proved very useful for both hedging and investment purposes,  they have a number of weaknesses. First,  forward markets are not organized through an exchange. This means that in order to take a position in a forward contract,  you must first find someone willing to take the opposite position. This is the double-coincidence-of-wants problem. Second,  because forward contracts are not exchange-traded,  there can sometimes be problems with price transparency and liquidity. Finally,  in addition to the financial risk of a forward contract,  there is also *counter-party risk*. This is the risk that one party to the forward contract will default on it's obligations. These problems have been eliminated to a large extent through the introduction of futures markets. That is not to say that forward markets are now redundant; they are not,  and they are used,  for example,  in the many circumstances when suitable futures markets are not available.

Perhaps the best way to understand the mechanics of a futures market is by example.

## Example 5 (Cricket Futures)

We consider an example of a futures market where the futures contracts are not written on an underlying financial asset or commodity. Instead,  they are written on the total number of runs that are scored in a cricket test match. The market opens before the cricket match takes place and expires at the conclusion of the match.

Similar futures markets do exist in practice and this example simply demonstrates that in principle,  futures markets can be created where just about any underlying variable can serve as the underlying asset.

The particular details of the cricket futures market are as follows:

- The futures market opens on June 3rd and the test match itself begins on June 15th. The market closes when the match is completed on June 19th.
- The closing price on the first day of the market was 720. This can be interpreted as the market forecast for the total number of runs that will be scored by both teams in the test match. This value varies through time as new events occur and new information becomes available. Examples of such events include information regarding player selection and fitness,  current form of players,  weather forecast updates,  umpire selection,  condition of the field etc.
- The *contract size* is $1. This means if you go *long* one contract and the price increases by one,        then you will have $1 added to your cash balance. On the other hand,  if the price had decreased by 8,  say,  and you were short 5 contracts then your balance would decrease by $40. This process of *marking-to-market* is usually done on a daily basis. Moreover,  the value of your futures position immediately after marking-to-market is identically zero,  as any accrued profits or losses have already been added to or subtracted from your cash balance.

In the table below we present one possible evolution of the futures market between June 3 and June 19. The initial position is 100 contracts and it is assumed that this position is held until the test match ends on June 19.

An initial balance of $10,  000 is assumed and this balance earns interest at a rate of0.\1% per day. It is also important to note that when the futures position is initially adopted the cost is zero,  i.e. initially there is no exchange of cash.

Remark 1 You should make sure that you fully understand the mechanics of this futures market as these are the same mechanics used by other futures markets.

| CRICKET FUTURES CONTRACTS   |        |          |        |          |         |                   |
|-----------------------------|--------|----------|--------|----------|---------|-------------------|
| Date                        | Price  | Position | Profit | Interest | Balance |                   |
| June 3                      | 720.00 | 100      | 0      | 0        | 10,       000  |                   |
| June 4                      | 721.84 | 100      | 184    | 1        | 10,       184  |                   |
| June 5                      | 721.52 | 100      | -31    | 1        | 10,       153  |                   |
| June 6                      | 711.88 | 100      | -964   | 1        | 9,       190   |                   |
| June 7                      | 716.67 | 100      | 479    | 0        | 9,       669   |                   |
| June 8                      | 720.04 | 100      | 337    | 0        | 10,       006  |                   |
| June 9                      | 672.45 | 100      | -4,       759 | 1        | 5,       248   | Any explanation?  |
| June 10                     | 673.25 | 100      | 80     | 0        | 5,       328   |                   |
| June 11                     | 687.04 | 100      | 1,       379  | 0        | 6,       708   |                   |
| June 12                     | 670.56 | 100      | -1,       648 | 0        | 5,       060   |                   |
| June 13                     | 656.25 | 100      | -1,       431 | 0        | 3,       630   |                   |
| June 14                     | 647.14 | 100      | -912   | 0        | 2,       718   |                   |
| June 15                     | 665.57 | 100      | 1,       843  | 0        | 4,       561   | Test Match Begins |
| June 16                     | 673.48 | 100      | 791    | 0        | 5,       353   |                   |
| June 17                     | 672.88 | 100      | -60    | 0        | 5,       293   |                   |
| June 18                     | 646.63 | 100      | -2,       625 | 0        | 2,       669   |                   |
| June 19                     | 659.58 | 100      | 1,       294  | 0        | 3,       963   | Test Match Ends   |
| Total                       | -6,       042 | 3,       963    |        |          |         |                   |

In Example 5 we did not discuss the details of *[[Lecture 6-Leverage, Tail Risk, Volatility Products#6.1.3 Margin requirements|margin requirements]]* which are intended to protect against the risk of default. A typical [[Lecture 6-Leverage, Tail Risk, Volatility Products#6.1.3 Margin requirements|margin requirement]] would be that the futures trader maintain a minimum *balance* in her trading account. This minimum balance will often be a function of the contract value (perhaps 5% to 10%)
multiplied by the position,  i.e.,  the number of contracts that the trader is long or short. When the balance drops below this minimum level a *margin call* is made after which the trader must deposit enough funds so as to meet the balance requirement. Failure to satisfy this margin call will result in the futures position being *closed out*.

## 3.1 Strengths And Weaknesses Of Futures Markets

Futures markets are useful for a number of reasons:

- It is easy to take a position using futures markets without having to purchase the underlying asset. Indeed,  it is not even possible to buy the underlying asset in some cases,  e.g.,  interest rates,  cricket matches and presidential elections.
- Futures markets allow you to *leverage* your position. That is,  you can dramatically increase your exposure to the underlying security by using the futures market instead of the spot market.
- They are well organized and designed to eliminate counter-party risk as well as the
"double-coincidence-of-wants" problem.

- The mechanics of a futures market are generally independent of the underlying 'security' so they are easy to "operate" and easily understood by investors.

Futures markets also have some weaknesses:

- The fact that they are so useful for leveraging a position also makes them dangerous for unsophisticated and/or rogue investors.
- Futures prices are (more or less) *linear* in the price of the underlying security. This limits the types of risks that can be perfectly hedged using futures markets. Nonetheless,  non-linear risks can still be partially hedged using futures. See,  for instance,  Example 7 below.

## 3.2 Relationship Of Futures Prices To Forward And Spot Prices

While forwards and futures prices are clearly closely related,  they are not equal in general. One important case where they do coincide is when interest rates are deterministic and a proof of this may be found in Section 10.7 of Luenberger. However,  we will see a more general proof of this and related results after we have studied martingale pricing.

When interest rates are stochastic,  as they are in the real world,  forwards and futures prices will generally not coincide. In particular,  when movements in interest rates are positively correlated with price movements in the asset underlying the futures contract,  futures prices will tend to be higher than the corresponding forward price.

Similarly,  when the correlation is negative,  the futures price will tend to be lower than the forward price. We will see an explanation for this after we have studied martingale pricing.

Another interesting question that arises is the relationship between F and E[ST],  where ST is the price of the underlying asset at the expiration date,  T. In particular,  we would like to know whether F < E[ST],  F = E[ST] or F > E[ST]. We can already guess at the answer to this question. Using the language of the CAPM,  for example,  we would expect (why?) F < E[ST] if the underlying security has positive systematic risk,  i.e.,  a positive beta.

## 3.3 Hedging With Futures: The Perfect And Minimum-Variance Hedges

Futures markets are of great importance for hedging against risk. They are particularly suited to hedging risk that is *linear* in the underlying asset. This is because the final payoff at time T from holding a futures contract is linear8in the terminal price of the underlying security,  ST. In this case we can achieve a perfect hedge by taking an equal and opposite position in the futures contract.

## Example 6 (Perfect Hedge)

Suppose a wheat producer knows that he will have 100,  000 bushels of wheat available to sell in three months time. He is concerned that the spot price of wheat will move against him (i.e. fall) in the intervening three months and so he decides to lock in the sale price now by hedging in the futures markets. Since each wheat futures contract is for 5,  000 bushels,  he therefore decides to sell 20 three-month futures contracts. Note that as a result,  the wheat producer has a perfectly hedged position. In general,  perfect hedges are not available for a number of reasons:

1. None of the expiration dates of available futures contracts may exactly match the expiration date of the payoff,  PT,  that we want to hedge.
1. PT may not correspond exactly to an *integer* number of futures contracts. 3. The security underlying the futures contract may be different to the security underlying PT. 4. PT may be a non-linear function of the security price underlying the futures contract.
1. Combinations of all the above are also possible.

8The final payoff is ±x(FT − F0) = ±x(ST − F0) depending on whether or not we are long or short x futures contracts and this position is held for the entire period,  [0,  T]. This assumes that we are ignoring the costs and interest payments associated with the margin account. As they are of of secondary importance,  we usually do this when determining what hedging positions to take.
When perfect hedges are not available,  we often use the *minimum-variance* hedge to identify a good hedging position in the futures markets. To derive the minimum-variance hedge,  we let ZT be the cash flow that occurs at date T that we wish to hedge,  and we let Ft be the time t price of the futures contract. At date t = 0 we adopt a position9 of h in the futures contract and hold this position until time T. Since the initial cost of a futures position is zero,  we can (if we ignore issues related to interest on the margin account) write the terminal cash-flow,  YT,  as

$$Y_{T}\ \ =\ \ Z_{T}\ +\ h(F_{T}-F_{0}).$$

Our objective then is to minimize

${\rm Var}(Y_{T})={\rm Var}(Z_{T})+h^{2}{\rm Var}(F_{T})+2h{\rm Cov}(Z_{T},       \ F_{T})$.
and we find that the minimizing h and minimum variance are given by

  **A and minimum variance are given by** $$\begin{array}{ccccc}h^{*}&=&-&\frac{\mbox{Cov}(Z_{T},       F_{T})}{\mbox{Var}(F_{T})}\\ \mbox{Var}(Y_{T}^{*})&=&\mbox{Var}(Z_{T})&-&\frac{\mbox{Cov}(Z_{T},       \ F_{T})^{2}}{\mbox{Var}(F_{T})}.\end{array}$$
Such *static hedging strategies* are often used in practice,  even when dynamic hedging strategies are capable of achieving a smaller variance. Note also,  that unless E[FT] = F0,  it will not be the case that E[ZT] = E[Y
∗
T
]. It is also worth noting that the mean-variance hedge is not in general the same as the *equal-and-opposite* hedge.

Example 7 (Luenberger Exercise 10.14)
Assume that the cash flow is given by y = ST W + (FT − F0)h. Let σ 2 S = Var(ST),  σ 2 F = Var(FT) and σST = Cov(ST,  FT). In an equal and opposite hedge,  h is taken to be an opposite equivalent dollar value of the hedging instrument. Therefore h = −kW,  where k is the price ratio between the asset and the hedging instrument. Express the standard deviation of y with the equal and opposite hedge in the form

That is,  find $ B_{\mu\nu}$.
$$\sigma_{y}~=~W\sigma_{S}~\times~B.$$
Solution: We have y = ST W − (FT − F0)W k where k = S0/F0. Note that h is determined at date 0 and is therefore a function of date 0 information only. It is easy to obtain

$$\begin{array}{r c l}{{}}&{{}}&{{}}\\ {{\sigma_{y}^{2}}}&{{=}}&{{W^{2}\sigma_{S}^{2}\ +\ \frac{W^{2}S_{0}^{2}}{F_{0}^{2}}\ \sigma_{F}^{2}\ -\ 2\frac{W^{2}S_{0}}{F_{0}}\ \sigma_{S,       F}}}\\ {{}}&{{}}&{{}}\\ {{\Rightarrow\ \sigma_{y}}}&{{=}}&{{W\sigma_{S}\ \sqrt{1\ +\ \left(\frac{S_{0}\sigma_{F}}{F_{0}\sigma_{S}}\right)^{2}\ -\ 2\frac{S_{0}\sigma_{S,       F}}{F_{0}\sigma_{S}^{2}}}}}\end{array}$$
which implicitly defines B.
As a check,  suppose that ST and FT are perfectly correlated. We then obtain (check) that
$$\sigma_{y}~=~W\sigma_{S}\left(1~-~\frac{S_{0}\sigma_{F}}{F_{0}\sigma_{S}}\right)$$

which is not in general equal to 0! However,  if Ft and St are scaled appropriately (alternatively we could scale h),  then we can obtain a perfect hedge.

9A positive value of h implies that we are long the futures contract while a negative value implies that we are short. More generally,  we could allow h to vary stochastically as a function of time. We might want to do this,  for example,  if ZT is *path* dependent or if it is a non-linear function of the security price underlying the futures contract. When we allow h to vary stochastically,  we say that we are using a *dynamic hedging strategy*. Such strategies are often used for hedging options and other derivative securities with non-linear payoffs.
Example 8 (Hedging Operating Profits)
A firm manufactures a particular type of widget. It has orders to supply D1 and D2 of these widgets at dates t1 and t2,  respectively. The revenue,  R,  of the corporation may then be written as R = D1P1 + D2P2 where Pi represents the price per widget at time ti. We assume that Piis stochastic and that it will depend in part on the general state of the economy at date ti. In particular,  we assume Pi = aSi e i + c where a and c are constants,  Siis the time ti value of the market index,  and 1 and 2 are independent random variables that are also independent of Si. Furthermore,  they satisfy E[e i] = 1 for each i. The firm wishes to hedge the revenue,  R,  by taking a position h at t = 0 in a futures contract that expires at date t2 and where the market index is the underlying security. The date t2 payoff,  Y,  is then given by Y = D1 (aS1 e 1 + c) + D2 (aS2 e 2 + c) + h(S2 − F0).

If we assume that St is a geometric Brownian motion so that St = S0 exp (µ − σ 2/2)t + σBt where Bt is a standard Brownian motion,  we can easily find the minimum variance hedge,  h
∗ = −Cov(*R,  S*2)/Var(S2).

Exercise 3 *Compute* h
∗*and the variance reduction that is achieved.*
Remark 2 A more sophisticated hedge would be to choose a position of size h1 *at date* t = 0 and then to update this position to h2 at date t1 where h1 and h2 *are constants that are chosen at date* t = 0. In this case the resulting hedging strategy is still a static hedging strategy.

Note,  however,  that since h2 need not be chosen until date t1,  it makes sense to allow h2 to be a function of available information at date t1. In particular,  we could allow h2 to depend on P1 and S1,  thereby obtaining a dynamic hedging strategy,  (h1,  h2(P1,  S1)). Such a strategy should be able to eliminate most of the uncertainty in R.

Exercise 4 *How would you go about solving for the optimal* (h
∗ 1
,  h∗
2
(P1,  S1))*? Would you need to make an* assumption regarding F1?

Note that the most general class of dynamic hedging strategy would allow you to adjust h stochastically at every date in [0,  t2) and not just at dates t0 and t1.

## 3.4 Final Remarks

As stated earlier,  futures markets generally work in much the same way,  regardless of the underlying asset.

Popular futures markets include interest rate futures and equity index futures. Interest futures,  for example,  can be used to immunize bond portfolios by matching durations and/or convexities. Index futures are used in place of the actual index itself for hedging index options. Of course,  interest rate and index futures are also used for many other reasons.

Sometimes the expiration dates of available futures contracts are sooner than the expiration date of some obligation or security that needs to be hedged. In such circumstances,  it is often common to roll the hedge forward. That is,  a hedging position in an available futures contract is adopted until that futures contract expires. At this point the futures position is closed out and a new position in a different (and newly available)
futures contract is adopted. This procedure continues until the expiration date of the obligation or security. Exercise 5 What types of risk do you encounter when you roll the hedge forward?

In order to answer Exercise 5,  assume you will have a particular asset available to sell at time T2. Today,  at time t = 0,  you would like to hedge your time T2 cash-flow by selling a single futures contract that expires at time T2 with the given asset as the underlying security. Such a futures contract,  however,  is not yet available though there is a futures contract available at t = 0 that expires at time T1 < T2. Moreover,  upon expiration of this contract the futures contract with expiration T2 will become available. You therefore decide to adopt the following strategy: at t = 0 you sell one unit of the futures contract that expires at time T1. At T1 you close out this contract and then sell one unit of the newly available futures contract that expires at time T2. What is your net cash-flow,  i.e. after selling the asset and closing out the futures contract,  at time T2?

Note that we have only discussed the mechanics of futures markets and how they can be used to hedge linear and non-linear risks. We have not seen how to compute the futures price,  Ft,  but instead will return to this after we have studied martingale pricing.

## 4 Introduction To Options And The Binomial Model

We first define the main types of options,  namely European and American call and put options.

Definition 2 A European call (put) option gives the right,  but not the obligation,  to buy (sell) 1 unit of the underlying security at a pre-specified price,  K*,  at a pre-specified time,  * T. Definition 3 An American call (put) option gives the right,  but not the obligation,  to buy (sell) 1 *unit of the* underlying security at a pre-specified price,  K,  at any time up to an including a pre-specified time,  T.

K and T are called the strike and maturity / expiration of the option,  respectively. Let St denote the price of the underlying security at time t. Then,  for example,  if ST < K a European call option will expire worthless and the option will not be *exercised*. A European put option,  however,  would be exercised and the payoff would be K − ST. More generally,  the payoff at maturity of a European call option is max{ST − K,  0} and its intrinsic value at any time *t < T* is given by max{St − K,  0}. The payoff of a European put option at maturity is max{K − ST,  0} and its *intrinsic value* at any time *t < T* is given by max{K − St,  0}.

## 4.1 Model Free Bounds For Option Prices

Because the underlying security price process,  St,  is stochastic and the option payoffs are non-linear functions of the underlying security price,  we cannot price options without a model. We can,  however,  obtain some model-free bounds for options prices. We let cE(t; *K,  T*) and pE(t; *K,  T*) denote the time t prices of a European call and put,  respectively,  with strike K and expiration T. Similarly,  we let cA(t; *K,  T*) and pA(t; *K,  T*) denote the time t prices of an American call and put,  respectively,  with strike K and expiration T. It should be clear that the price of an American option is greater than or equal to the price of the corresponding European option.

## Put-Call Parity

A very important result for European options is put-call parity. Suppose the underlying security does not pay dividends. We then have pE(t; *K,  T*) + St = cE(t; *K,  T*) + Kd(*t,  T*) (7)
where d(*t,  T*) is the discount factor used to discount cash-flows from time T back to time t. We can prove (7)
by considering the following trading strategy:

- At time t buy one European call with strike K and expiration T
- At time t sell one European put with strike K and expiration T - At time t sell short 1 unit of the underlying security and buy it back at time T
- At time t lend K d(*t,  T*) dollars up to time T
Regardless of the underlying security price,  it is easy to see that the cash-flow at time T corresponding to this strategy will be zero. No-arbitrage then implies that the value of this strategy at time t must therefore also be zero. We therefore obtain −cE(t; *K,  T*) + pE(t; *K,  T*) + St − Kd(*t,  T*) = 0 which is (7).

When the underlying security does pay dividends then a similar argument can be used to obtain

$$p_{E}(t;K,       T)+S_{t}-D=c_{E}(t;K,       T)+K d(t,       T)$$
pE(t; *K,  T*) + St − D = cE(t; *K,  T*) + Kd(*t,  T*) (8)
where D is the present value of all dividends until maturity.

Suppose now the underlying security does not pay dividends and that the events {ST > K} and {ST < K}
have strictly positive probability so that (why?) cE(t; *K,  T*) > 0 and pE(t; *K,  T*) > 0. We can then use put-call parity to obtain cE(t; *K,  T*) = St + pE(t; K,  T) − Kd(t,  T) > St − Kd(*t,  T*). (9)
Consider now the corresponding American call option. We obtain

$c_{A}(t,       K,       T)\geq c_{E}(t;K,       T)>\max\left\{S_{t}-Kd(t,       T),       \,       0\right\}\geq\max\left\{S_{t}-K,       0\right\}$.
Therefore the price of an American call on a non-dividend-paying stock is always strictly greater than the intrinsic value of the call option when the events {ST > K} and {ST < K} have strictly positive probability.

We have thus shown that it is never optimal to early-exercise an American call on a non-dividend paying stock and so cA(t; *K,  T*) = cE(*t,  K,  T*). Unfortunately there is no such result relating American put options to European put options. Indeed it is sometimes optimal to early exercise an American put option even when the underlying security does not pay a dividend.

## 4.2 The 1-Period Binomial Model

Consider the 1-period binomial model where the underlying security has a value of S0 = 100 at t = 0 and increases by a factor of u or decreases by a factor of d in the following period. We also assume that borrowing or lending at a gross risk-free rate of R is possible.

This means that $1 in the cash account at t = 0 will be worth $R at t = 1. We also assume that short-sales are allowed.

![11_image_0.png](11_image_0.png)

$$({\boldsymbol{\delta}})$$
$$({\mathfrak{g}})$$

Suppose now that S0 = 100,  R = 1.01,  u = 1.07 and d = 1/u =0.\1. Some interesting questions now arise:

1. How much is a call option that pays max(S1 − 107,  0) at t = 1 worth? 2. How much is a call option that pays max(S1 − 92,  0) at t = 1 worth?

Pricing these options is easy but to price options in general we need more general definitions of arbitrage. Definition 4 A type A *arbitrage is a security or portfolio that produces immediate positive reward at* t = 0 and has non-negative value at t = 1. i.e. a security with initial cost,  V0 < 0*,  and time* t = 1 *value* V1 ≥ 0.

Definition 5 A type B *arbitrage is a security or portfolio that has a non-positive initial cost,  has positive* probability of yielding a positive payoff at t = 1 *and zero probability of producing a negative payoff then.* i.e. a security with initial cost,  V0 ≤ 0,  and V1 ≥ 0 but V1 6= 0.

We now have the following result. Theorem 1 There is no arbitrage in the 1-period binomial model if and only if d < R < u.

Proof: (i) Suppose *R < d < u*. Then at t = 0 we should borrow S0 and purchase one unit of the stock.

(ii) Suppose *d < u < R*. Then short-sell one unit of the stock at t = 0 and invest the proceeds in cash-account. In both cases we have a type B arbitrage and so the result follows.

We will soon see the other direction,  i.e. if *d < R < u*,  then there can be no-arbitrage. Let's return to our earlier numerical example and consider the following questions:

1. How much is a call option that pays max(S1 − 102,  0) at t = 1 worth?
1. How will the price vary as p varies?

To answer these questions,  we will construct a *replicating* portfolio. Let us buy x shares and invest y in the cash account at t = 0. At t = 1 this portfolio is worth:

$107x+1.01y$ when $S=107$ $93.46x+1.01y$ when $S=93.46$
Can we choose x and y so that portfolio equals the option payoff at t = 1? We can indeed by solving

$\begin{array}{ccc}107x+1.01y&=&5\\ \\[-4mm]93.46x+1.01y&=&0\end{array}$.
and the solution is x = 0.3693 and y = −34.1708. Note that the cost of this portfolio at t = 0 is 0.3693 × 100 − 34.1708 × 1 ≈ 2.76.

This implies the fair or arbitrage-free value of the option is 2.76. Derivative Security Pricing in the 1-Period Binomial Model Can we use the same replicating portfolio argument to find the price,  C0,  of any derivative security with payoff function,  C1(S1),  at time t = 1? Yes we can by setting up replicating portfolio as before and solving the following two linear equations for x and y

$$\begin{array}{r c l c r}{{u S_{0}x+R y}}&{{=}}&{{C_{u}}}&{{}}&{{}}&{{(10)}}\\ {{d S_{0}x+R y}}&{{=}}&{{C_{d}}}&{{}}&{{}}&{{(11)}}\end{array}$$
dS0x + Ry = Cd (11) t = 0 t = 1

![12_image_0.png](12_image_0.png)

$$(12)$$

The arbitrage-free time t = 0 price of the derivative must (Why?) then be C0:= xS0 + y. Solving (10) and
(11) then yields

$$\begin{array}{r c l}{{C_{0}}}&{{=}}&{{\frac{1}{R}\left[\frac{R-d}{u-d}C_{u}+\frac{u-R}{u-d}C_{d}\right]}}\\ {{}}&{{=}}&{{\frac{1}{R}\left[q C_{u}+(1-q)C_{d}\right]}}\\ {{}}&{{=}}&{{\frac{1}{R}\mathrm{E}_{0}^{Q}[C_{1}]}}\end{array}$$
[C1] (12)
where q:= (R − d)/(u − d) so that 1 − q = (u − R)/(u − d). Note that if *d < R < u* then q > 0 and 1 − q > 0 and so by (12) there can be (why?) no-arbitrage. We refer to (12) as *risk-neutral pricing* and (q,  1 − q) are the risk-neutral probabilities. So we now know how to price any derivative security in this 1-period binomial model via a replication argument. Moreover this replication argument is equivalent to pricing using risk-neutral probabilities.

We also note that the price of the derivative does not depend on p! This at first appears very surprising. To understand this result further consider the following two stocks,  ABC and XYZ:

![13_image_1.png](13_image_1.png)

![13_image_0.png](13_image_0.png)

Note that the probability of an up-move for ABC is p =0.\1 whereas the probability of an up-move for XYZ is p =0.\1. Consider now the following two questions:
Question: What is the price of a call option on ABC with strike K = $100?

Question: What is the price of a call option on XYZ with strike K = $100? You should be surprised by your answers. But then if you think a little more carefully you'll realize that the answers are actually not surprising *given* the premise that two stocks like ABC and XYZ actually exist side-by-side in the market.

## 4.3 The Multi-Period Binomial Model

Consider the multi-period binomial model displayed to the right where as before we have assumed u = 1/d =
1.07. The important thing to notice is that the multiperiod model is just a series of 1-period models spliced together! This implies all the results from the 1-period model apply and that we just need to multiply 1-period probabilities along branches to get probabilities in the multi-period model.

![13_image_2.png](13_image_2.png)

## Pricing A European Call Option

Suppose now that we wish to price a European call option with expiration at t = 3 and strike = $100. As before we assume a gross risk-free rate of R = 1.01 per period. We can do this by working backwards in the lattice starting at time t = 3 and using what we know about 1-period binomial models to obtain the price at each prior node.

We do this repeatedly until we obtain the arbitrage-free price at t = 0. The price of the option at each node is displayed above the underlying stock price in the binomial model to the right. Note that we repeatedly used (12) to obtain these prices.

![13_image_3.png](13_image_3.png)
2(1 − q)

2

$$(13)$$

3
For example,  the upper node at t = 1 has a value of 10.23. This is the value of the derivative security that pays either 15.48 (after an up-move) or 3.88 (after a down-move) 1 period later. It is not hard to see that the process of backwards evaluation that we just described is equivalent to pricing the option as

$$C_{0}=\frac{1}{R^{3}}\mathrm{E}_{0}^{Q}\left[\operatorname*{max}(S_{T}-100,       \ 0)\right]$$
[max(ST − 100,  0)] (13)
and we note the risk-neutral probabilities for ST are displayed at the far right in the binomial lattice above.

Risk-neutral pricing pricing via (13) has the advantage of not needing to calculate the option price at every intermediate node. Question: How would you find a *replicating strategy* for the option?

## Pricing An American Put Option

We can price American options in the same way as European options only now at each node we must also check to see if it's optimal to early exercise there. Recall,  however,  that it is never optimal to early exercise an American call option on non-dividend paying stock. So instead will price an American put option with expiration at t = 3 and strike K = $100. Once again we assume R = 1.01.

The American option price at each node is displayed in the lattice to the left. As before we start at expiration t = 3 where we know the value of the option. We then work backwards in the lattice and at each node we set the value equal to the maximum of the intrinsic value and the (risk-neutral) expected discounted value one period ahead.

✏✏✏✏✏✏✏✏✏✏✏✏✏✏✏✏✏
PPPPPPPPPPPPPPPPP

![14_image_1.png](14_image_1.png)

t = 0 t = 1 t = 2 t = 3

![14_image_0.png](14_image_0.png)

PPPPPPPPP✏

93.46 93.46
For example,  the value of the option at the lower node at time t = 2 is given by

$$12.66=\operatorname*{max}\left[12.66,       \ {\frac{1}{R}}\left(q\times6.54+(1-q)\times18.37\right)\right]$$

where 12.66 = 100 − 87.34 is the intrinsic value of the option at that node. More generally,  the value,  Vt(S),  of the American put option at any time t node when the underlying price is S can be computed according to

$$V_{t}(S)=\max\left[K-S,       \ \frac{1}{R}\left[q\times V_{t+1}(uS)+(1-q)\times V_{t+1}(dS)\right]\right]$$ $$=\max\left[K-S,       \ \frac{1}{R}\mbox{E}_{t}^{Q}\left[V_{t+1}(S_{t+1})\right]\right].$$

We will return to option pricing in much greater generality when we study martingale pricing.

## Appendix A: Calibrating The Binomial Model To Geometric Brownian Motion

In continuous-time models,  it is often assumed that a security price process follows a *geometric Brownian motion*
(GBM) which is the continuous-time analog to the binomial model. In that case we write St ∼ GBM(*µ,  σ*) if

$S_{t+s}\;=\;S_t\;e^{(\mu-\sigma^2/2)s\;+\;\sigma(B_{t+s}-B_t)}$.
$\left(14\right)$.
2/2)s + σ(Bt+s−Bt)(14)
where Bt is a standard Brownian motion. Note that this model (like the binomial model) has the nice property that the gross return,  Rt,  t+s,  in any period,  [*t,  t* + s],  is independent of returns in earlier periods. In particular,  it is independent of St. This follows by noting

### 1.3) …….g $R_{t,       t+s}\;=\;\dfrac{S_{t+s}}{S_t}\;=\;e^{(\mu-\sigma^2/2)s\;+\;\sigma(B_{t+s}-B_t)}$

and noting the independent increments property of Brownian motion. It is appealing that Rt,  t+s is independent of St since it models real world markets where investors care only about returns and not the absolute price level of securities. The binomial model has similar properties since the gross return in any period of the binomial model is either u or d,  and this is independent of what has happened in earlier periods.

We often wish to *calibrate* the binomial model so that its dynamics match that of the geometric Brownian motion in (14). To do this we need to choose u,  d and p,  the real-world probability of an up-move,  appropriately. There are many possible ways of doing this,  but one of the more common10 choices is to set

$\begin{array}{ccc}\text{-}&\text{-}\\ p&=&\dfrac{e^{\mu\Delta t}-d}{u-d}\\ \\[-3mm]u&=&\exp(\sigma\sqrt{\Delta t})\\ \\[-3mm]d&=&1/u\;=\;\exp(-\sigma\sqrt{\Delta t})\end{array}$.
u − d(15)
where T is the expiration date and ∆t is the length of a period. Note then,  for example,  that E[Si+1|Si] = puSi + (1 − p)dSi = Si exp(µ∆t),  as desired. We will choose the gross risk-free rate per period,  R,  so that it corresponds to a continuously-compounded rate,  r,  in continuous time. We therefore have

$$\left(15\right)$$
$R\;=\;e^{r\Delta t}$.
Remark 3 Recall that the true probability of an up-move,  p*,  has no bearing upon the risk-neutral probability,  *
q*,  and therefore it does not* directly *affect how securities are priced. From our calibration of the binomial model,  *
we therefore see that µ,  which enters the calibration only through p,  does not impact security prices. On the other hand,  u and d depend on σ which therefore does impact security prices. This is a recurring theme in derivatives pricing and we will revisit it when we study continuous-time models.

Remark 4 In the previous remark we stated that p *does not* directly affect how securities are priced. This means that if p should suddenly change but S0,  R,  u and d remain unchanged,  then q*,  and therefore derivative* prices,  would also remain unchanged. This seems very counter-intuitive but an explanation is easily given. In practice,  a change in p would generally cause one or more of S0,  R,  u and d *to also change. This would in turn* cause q,  and therefore derivative prices,  to change. We could therefore say that p *has an* indirect effect on derivative security prices. This of course is the point we were making when discussing the price of an option on stocks ABC and XYZ in Section 4.2. It is more typically the case,  however,  that we wish to calibrate a binomial model to the risk-neutral dynamics of a stock following a GBM model. In that case,  if the stock has a continuous dividend yield of c so that a dividend of size cSt dt is paid at time t then the risk-neutral dynamics of the stock can be shown to satisfy

$$S_{t+s}~=~S_{t}~e^{(r-c-\sigma^{2}/2)s}+\,       \sigma(B_{t+s}-B_{t})$$
$\left(16\right)$.
2/2)s + σ(Bt+s−Bt)(16)
where Bt is now a standard Brownian motion under the risk-neutral distribution. The corresponding q for the binomial model can be obtained from (15) with µ replaced by r − c with u and d unchanged.

10This calibration becomes more accurate as ∆t → 0. A more accurate calibration for larger values of ∆t can be found in Luenberger's text. It takes ln u =pσ2∆t + (ν∆t)
2,  d = 1/u and p = 1/2 + 1/(2pσ2/(ν∆t)
2 + 1) where ν:= µ − σ 2/2.